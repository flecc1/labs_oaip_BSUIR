#include <stdio.h>
#include <curses.h>
#include <limits.h>
#include <stdlib.h>
#include <time.h>


#define size 10 // объявляем размер массива константой 

int main ()
{
    int choise = 0;     // 1-ая проверка на ввод
    int choice;
    do
    {
        int arr[size]; //создаем массив из size элементов


         // Цикл для проверки ввода способа заполнения массива
        while (1)
        {
            printf("\033[1;32mВыберите способ заполнения массива:\n");
            printf("\033[1;32m1. Ввести элементы вручную\n");
            printf("\033[1;32m2. Заполнить массив случайными числами\n");
            printf("\033[1;32mВаш выбор: ");
            
            if (scanf("%d", &choice) != 1)
            { // проверка корректности ввода
                printf("\033[1;31mТакой символ не подходит, введите число 1 или 2.\n");
                rewind(stdin);
                continue;
            }

            // Проверка на правильность выбора (1 или 2)
            if (choice == 1 || choice == 2)
            {
                break;
            }
            else
            {
                printf("\033[1;31mНеверный выбор! Пожалуйста, введите 1 или 2.\n");
            }
        }

        if(choice == 1)
        {
            printf("\033[1;32mвведите элементы массива\n");   // вывод сообщения "введите элементы массива"
            for (int i = 0; i < size; i++)      // цикл для ввода элементов массива
            {
                while(1)                    // бесконечный цикл для проверки на ввод элемента массива
                {
                    printf("\033[1;32mэлемент масива %d: ", i + 1);       //вывод элемент масвиа i-го номера
                    rewind(stdin);                              // очистка буфера           
                    if(scanf("%d", &arr[i])!= 1)                            // условие проверки
                    {
                        printf("\033[1;31mданный символ не подходит введите цифру\n");    // вывод сообщения "данный символ не подходит введите цифру"
                    }
                    else if(arr[i] < 0 || arr[i] > INT32_MAX) // проверка что число в нужном диапозоне
                    {
                        printf("\033[1;31mчисло должно быть положительным и до %d\n", INT32_MAX); // вывод сообщения "число должно быть положительным и до 10000"
                    }
                    else
                    break;
                }
            }
        }
        else if(choice == 2)
        {
            // Инициализация генератора случайных чисел
            srand(time(NULL));
            printf("\033[1;32mМассив будет заполнен случайными числами.\n");
            for (int i = 0; i < 10; i++)
            {
                arr[i] = rand() % 2001 - 1000; // случайные числа в диапазоне от -1000 до 1000
            }
        }
        
        printf("\n");
        printf("\033[1;32mстарый массив: \n\n\n");
        for(int i = 0; i < size; i ++)
        {
            printf("%10d ", arr[i]);
        }
        printf("\n\n");

        for (int i = 0; i < size; i++)
        {
            int found = 0; //это переменная-флаг указывает был ли найден элемент больший текущего arr[i].
            for(int j = i + 1; j < size; j ++) // цикл для поиска последующего большего элемента
            {
                if(arr[j] > arr[i]) // проверка условия больше ли arr[j] arr[i]
                {
                    arr[i] = arr[j]; // текущий элемент меняеться на найденый больший
                    found = 1;       // устанавливается в 1 указывая что был найден больший элемент
                    break;
                }
            }
            if(!found)  // проверка флага если не произошло break и found осталась равной 0
            // текущий элемент arr[i] устанавливается в 0.
            // Это означает, что для данного элемента не был найден больший элемент в оставшейся части массива.
            {
                arr[i] = 0; // присваеваем arr[i] значение 0
            }  
        }


        printf ("\033[1;32mновый масив: \n\n\n"); //вывод сообщения "новый массив"
        for (int i = 0; i < size; i ++)     // цикл для вывода массива
        {
            printf("%10d ", arr[i]);      // вывод arr[i]
        }
        printf("\n\n");
        while(1)    // цикл для проверки на ввод
        {
            printf("\033[1;32mвведите 1 если хотите рестарт любой другой символ - конец программы:   \n"); // вывод сообщения "введите 1 если рестарт иначе конец"
            rewind(stdin);  // очистка буфера
            if(scanf("%d", &choise) != 1)    // условие проверки
            {
                printf("\033[1;31mтакой символ не подходит введите число \n"); // вывод сообщения "такой символ не подходит введите число"
            }
            else if(choise < 0 || choise > INT32_MAX) // проверка что число в нужном диапозоне
            {
                printf("\033[1;31mчисло должно быть положительным и до %d\n", INT32_MAX); // вывод сообщения "число должно быть положительным и до 10000"
            }
            else break;
        }
    }
    while(choise == 1);         // условие глобального поиска
    printf("\033[1;32mпрограмма завершенна"); // вывод сообщения "программа завершенна"
    return 0;
}