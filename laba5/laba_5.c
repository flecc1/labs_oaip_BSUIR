#include <stdio.h>
#include <curses.h>
#include <limits.h>
#include <stdlib.h>
#include <time.h>

#define N 50 // задаем кол-во строк константой
#define M 50 // задаем кол-во столбцов константой



void bubleSort (int arr[], int m)   //объявление функции которая принимает 2 параметра (мессив целых чисел и кол-во элементов в массиве)
{
    for (int i = 0; i < m - 1; i ++) // цикл для кол-во проходов нужных для сортировки
    {
        for ( int  j = 0; j < m - i - 1; j ++) // цикл для выполнения сравнения и перестановки соседних элементов
        {
            if (arr[j] < arr[j + 1]) // услове для обмена элементов
            {
                int vrem = arr[j];  // сохраняем значение arr[j] во временню переменную
                arr[j] = arr[j + 1]; // перемещаем значение arr[j + 1] на позицию arr[j]
                arr[j + 1] = vrem; //присваеваем значение из временной переменной vrem на позицию arr[j + 1]
            }
        }
    }
}

int main ()
{
    int choice = 0;     // переменная котрая отвечает за рестарт программы 
    int n, m;
    do
    {
        printf("\033[1;32mэта программа сортирует строки массива по убыванию\n");
        printf("введиет рамеры матрицы\n");
        while(1)
        {
            printf("\033[1;32mвведите кол-во строк\n");
            if(scanf("%d", &n) != 1 || n < 1 || n > 50)
            {
                rewind(stdin);
                printf("\033[1;31mвведен некорекртный символ должно быть введено число от %d до %d\n", 1, 50);
            }
            else break;
        }
        while(1)
        {
            printf("\033[1;32mвведите кол-во столбцов\n");
            if(scanf("%d", &m) != 1 || m < 1 || m > 50)
            {
                rewind(stdin);
                printf("\033[1;31mвведен некорекртный символ должно быть введено число от %d до %d\n", 1, 50);
            }
            else break;
        }
        
        while (1)
        {
            printf("\033[1;32mВыберите способ заполнения массива:\n");
            printf("\033[1;32m1. Ввести элементы вручную\n");
            printf("\033[1;32m2. Заполнить массив случайными числами\n");
            printf("\033[1;32mВаш выбор: ");
            
            if (scanf("%d", &choice) != 1) // проверка корректности ввода
            { 
                printf("\033[1;31mТакой символ не подходит, введите число 1 или 2.\n");
                rewind(stdin);
                continue;
            }

            // Проверка на правильность выбора (1 или 2)
            if (choice == 1 || choice == 2)
            {
                break;
            }
            else
            {
                printf("\033[1;31mНеверный выбор! Пожалуйста, введите 1 или 2.\n");
            }
        } 
        int arr[N][M];      // создаем 2-уч мерный массив
        if(choice == 1)
        {
            for (int i = 0; i < N; i ++)    //цикл по строкам
            {
                for(int j = 0; j < M; j ++) // цикл по столбцам
                {   
                    while(1)        // цикл для проверки на ввод элемента массива
                    {
                        printf("\033[1;32mвведите элементы массива: [%d][%d]: ", i + 1, j + 1);   //вывод сообщения которое выводит номер массвиа в который записываеться значение 
                        rewind(stdin);                                                  // очистка буфера
                        if(scanf("%d", &arr[i][j]) != 1)                                                // проверка условия 
                        {
                            printf("\033[1;31mне коректный символ\n");        // вывод сообщения "не коректный символ"
                        }
                        else if(arr[i][j] < 0 || arr[i][j] > INT32_MAX)     // проверка что веденое число в нужном диапазоне
                        {
                            printf("\033[1;31mчисло должно быть положительным и до %d\n", INT32_MAX);
                        }
                        else
                        {
                            break;
                        }
                    }
                }
            }
        }
        else if (choice == 2)
        {
            // Инициализация генератора случайных чисел
            srand(time(NULL));
            printf("\033[1;32mМассив будет заполнен случайными числами.\n");
            for (int i = 0; i < N; i++)
            {
                for(int j = 0; j < M; j ++)
                {
                    arr[i][j] = rand() % 2001 - 1000; // случайные числа в диапазоне от -1000 до 1000
                }            
            }
        }
        
        printf("\n");
        printf("\033[1;32mстарый массив: \n");
        for (int i = 0; i < N; i ++)        // цикл по строкам
        {
            for (int j = 0; j < M; j ++)    // цикл по столбцам
            {
                printf("%10d", arr[i][j]);           //вывод элемента массива arr[i][j]
            }
            printf("\n\n");   //вывод кажой строки начинаетя с новой строки
        }

        for (int i = 0; i < N; i ++) //цикл каждой для сортировки каждой строки 2-ух мерного массива
        {
            bubleSort(arr[i], M); // вызов функции сортировки
        }
        printf("\033[1;32mновый массив: \n");
        // цикл для вывода сохраненых элементов массива
        for (int i = 0; i < N; i ++)        // цикл по строкам
        {
            for (int j = 0; j < M; j ++)    // цикл по столбцам
            {
                printf("%10d", arr[i][j]);           //вывод элемента массива arr[i][j]
            }
            printf("\n\n");   //вывод кажой строки начинаетя с новой строки
        }
        while(1)
        {
            printf("\033[1;32mеесли хоиите начать программ заново пишите 1, любой положительная цифра отичная от 1 ведет за собой выход программы:   \n");
            rewind(stdin); // очистка буфера
            if(scanf("%d", &choice) != 1) // условие проверки
            {
                printf("\033[1;31mтакой символ не подходит введите число \n"); // вывод сообщения "такой символ не подходит введите число"
            }
            else if(choice < 0 || choice > INT32_MAX) // проверка что число в нужном диапозоне
            {
                printf("\033[1;31mчисло должно быть положительным и до %d\n", INT32_MAX); //вывод сообщения которое говорит пользователю в каких границах должно быть вводимое число
            }
            else break;
        }
    }
    while (choice == 1);            // условие глобального цикла
    printf("\033[1;32mпрогрмма завершена");   // выввод сообщения "прогрмма завершена"
    return 0;
}
